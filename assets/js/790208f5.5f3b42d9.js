"use strict";(globalThis.webpackChunkinvictus_integration=globalThis.webpackChunkinvictus_integration||[]).push([[4526],{5727(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>m,frontMatter:()=>c,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"framework/transcoV2","title":"Promote user content from SQL in Logic App workflows with <u>Transco</u>","description":"Integration scenarios often need to \'promote\' or \'enrich\' messages/data from external stored systems. Codit is a long-term implementer of something called \'Transco\', which was previously a BizTalk component, but is now been required in modern Azure Logic Apps integrations.","source":"@site/versioned_docs/version-v6.0.0/framework/transcoV2.mdx","sourceDirName":"framework","slug":"/framework/transcoV2","permalink":"/framework/transcoV2","draft":false,"unlisted":false,"editUrl":"https://github.com/invictus-integration/docs-ifa/edit/master/docs/versioned_docs/version-v6.0.0/framework/transcoV2.mdx","tags":[],"version":"v6.0.0","frontMatter":{"sidebar_label":"Transco promotion"},"sidebar":"sidebar","previous":{"title":"Time-controlled sequence","permalink":"/framework/timesequencer"},"next":{"title":"Convert between XML/JSON","permalink":"/framework/xmljsonconverter"}}');var s=t(4848),i=t(8453),a=t(1470),o=t(9365);const c={sidebar_label:"Transco promotion"},l="Promote user content from SQL in Logic App workflows with Transco",d={},h=[{value:"Available endpoints",id:"available-endpoints",level:2},{value:"Transco config file",id:"transco-config-file",level:2},{value:"Customization",id:"customization",level:2},{value:"Migrating Transco v1 to v2",id:"migrating-transco-v1-to-v2",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components},{Details:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsxs)(n.h1,{id:"promote-user-content-from-sql-in-logic-app-workflows-with-transco",children:["Promote user content from SQL in Logic App workflows with ",(0,s.jsx)("u",{children:"Transco"})]})}),"\n",(0,s.jsxs)(n.admonition,{title:"motivation",type:"note",children:[(0,s.jsx)(n.p,{children:"Integration scenarios often need to 'promote' or 'enrich' messages/data from external stored systems. Codit is a long-term implementer of something called 'Transco', which was previously a BizTalk component, but is now been required in modern Azure Logic Apps integrations."}),(0,s.jsx)(n.p,{children:"Invictus provides a Transco component to promote properties from a database, by using the content or context to create the SQL query which will be executed against the specified table. Transco can also perform transformations on XML content by simply specifying the XSLT file from storage (Transco supports XSLT 1.0 syntax.)."})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Transco v2 XML example",src:t(445).A+"",width:"1793",height:"885"})}),"\n",(0,s.jsx)(n.h2,{id:"available-endpoints",children:"Available endpoints"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"/api/TranscoXML"}),": used with XML content. A Transco config file is used to list the instructions necessary to promote values from an SQL database or to transform the content via an XSLT file."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"/api/TranscoJson"}),": used with JSON content. A Transco config file is used to list the instructions necessary to promote values from an SQL database. Transformations cannot be performed on JSON content."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"/api/MatrixBasicPromote"}),": accepts a simple list of parameters and promotes them to the ",(0,s.jsx)(n.code,{children:"Context"})," in the response."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(a.A,{groupId:"transco-endpoints",children:[(0,s.jsxs)(o.A,{value:"json-xml",label:"XML/JSON",children:[(0,s.jsx)(n.p,{children:"The Transco request requires following values:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"XML/JSON content in BASE 64 format;"}),"\n",(0,s.jsx)(n.li,{children:"Context as key-value pair list;"}),"\n",(0,s.jsx)(n.li,{children:"Name of Transco config file in Azure Blob Storage."}),"\n"]}),(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:(0,s.jsx)(n.strong,{children:"Full request body JSON example"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'// POST /api/TranscoXML\n// POST /api/TranscoJson\n{\n  "Content": "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTE2Ij8+PHJvb3Q+PG5hbWUgc3RhdHVzPSJNZW1iZXIiPkpvaG4gRG9lPC9uYW1lPjwvcm9vdD4=",\n  "Context": {\n    "CustomerActive": "true" \n  }, \n  "TranscoConfig": "docs_config.json"\n}\n'})})]}),(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:(0,s.jsx)(n.strong,{children:"Full response body JSON example"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'// 200 OK <- /api/TranscoXML\n// 200 OK <- /api/TranscoJson\n{\n  "Content": "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTE2Ij8+PE1lbWJlcj5Kb2huIERvZTwvTWVtYmVyPg==",\n  "Context": {\n    "CustomerActive": "true"\n  },\n  "TranscoConfig": "docs_config.json"\n}\n'})})]}),(0,s.jsx)(n.h2,{id:"transco-config-file",children:"Transco config file"}),(0,s.jsx)(n.p,{children:"A JSON Transco config file is required to specify details about the instruction which will be performed. Instructions are executed in the order in which they appear. The name of the config file should be specified in the request so that it can be retrieved from the storage account."}),(0,s.jsxs)(a.A,{groupId:"Transco-instructions",children:[(0,s.jsxs)(o.A,{value:"sql-command",label:"SQL Commands",default:!0,children:[(0,s.jsx)(n.p,{children:"Transco can execute SQL commands to promote properties from a specified database and table. The connection to the database can be achieved via either a raw connection string or the name of an Azure Key Vault secret."}),(0,s.jsx)(n.p,{children:"The parameters of the SQL query can be populated from 3 sources:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"XML/JSON request content via XPath/JPath"}),"\n",(0,s.jsx)(n.li,{children:"Request context"}),"\n",(0,s.jsx)(n.li,{children:"Fixed value"}),"\n"]}),(0,s.jsxs)(n.p,{children:["The SQL query result will inserted at the specified ",(0,s.jsx)(n.code,{children:"destination"})," XPath or JPath. For XPaths ending at an attribute, e.g. ",(0,s.jsx)(n.code,{children:"/persons/person/@name"}),", the value will be inserted in that attribute. Otherwise, it will be inserted in the inner text."]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["A ",(0,s.jsx)(n.code,{children:"scopePath"})," can be defined so that the command affects only nodes within that path."]}),"\n",(0,s.jsx)(n.li,{children:"A connection to the SQL database must be provided (via a connection string in plain text or in an Azure Key Vault secret)."}),"\n",(0,s.jsxs)(n.li,{children:["Parameters in the SQL query must be denoted with an ",(0,s.jsx)(n.code,{children:"@"})," symbol. Parameters may be given a name or indexed with a number.","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"SELECT CustomerStatus FROM dbo.Customers WHERE CustomerName = @Name AND Active = @Active*\n-- or\nSELECT CustomerStatus FROM dbo.Customers WHERE CustomerName = @1 AND Active = @2*\n"})}),"\n"]}),"\n"]})]}),(0,s.jsxs)(o.A,{value:"xml-transformation",label:"XML Transformation",children:[(0,s.jsx)(n.p,{children:"Transformations can be performed on XML content. The name of the XSLT file in the storage account is required for this operation."}),(0,s.jsx)(n.p,{children:"This instruction can be added to the Transco Config to transform XML content via the specified XSLT file. Any required assemblies and dependencies used by the transformation can also be specified, while the respective DLL files are to be in the storage account."}),(0,s.jsxs)(n.p,{children:["This instruction is only available when calling the ",(0,s.jsx)(n.code,{children:"/TranscoXML"})," endpoint."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "xsltTransform": [Name of XSLT file],\n  "extensions": [\n    {\n      "namespace": [Assembly namespace],\n      "assemblyName": [Assembly name],\n      "className": [Assembly class name],\n      "dependencies": [\n        "[DLL dependency file name]",\n        "[DLL dependency file name]"\n      ]\n    }\n  ]\n}\n'})})]})]}),(0,s.jsxs)(n.admonition,{title:"storage account",type:"info",children:[(0,s.jsxs)(n.p,{children:["All required files are to be saved in an Azure Storage Account and in a Blob Storage container with the name: ",(0,s.jsx)(n.code,{children:"Transcov2configstore"})," (This container is automatically created by Invictus):"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"/Configs"})," folder with Transco config files"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"/XSLTs"})," folder with transformation files"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"/Assemblies"})," folder with assembly and dependency DLL files"]}),"\n"]})]}),(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:(0,s.jsx)(n.strong,{children:"Full Transco config file specification"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "instructions": [\n    {\n      "scopePath": [XPath/JPath of content scope],\n      "namespaces": [\n        {\n          "namespace": [XML Namespace],\n          "prefix": [XML Namespace prefix]\n        }\n      ],\n      "destination": [XPath/JPath of the results destination, or Context key if promoteToContext = true],\n      "promoteToContext": [If true query result is saved to Context at key destination],\n      "command": {\n        "databaseConnectionString":[Raw connection string to DB],\n         "databaseKeyVaultName": [Name of DB connection string secret in Key Vault],\n         "commandValue": [SQL query to be executed],\n         "isMandatory": [If true, will throw error when result is null],\n        "columnName": [Obtain value from specified column if query returns multiple fields. If empty, value from first column is obtained],\n         "defaultValue": [Default value of result],\n         "parameters": [\n           {\n            "paramName": [Name of param in query],\n             "value": [Type dependent. XPath or JPath if valueType = "path"],\n             "type": [SQL DB type. See: https://learn.microsoft.com/en-us/dotnet/api/system.data.sqldbtype],\n             "valueType": ["path" or "fixedValue" or "context"]\n          },\n          {\n            "paramName": [Name of param in query],\n            "value": [Type dependent. Any string value if valueType = "fixedValue"],\n            "type": [SQL DB type. See: https://learn.microsoft.com/en-us/dotnet/api/system.data.sqldbtype],\n            "valueType": ["path" or "fixedValue" or "context"]\n          },\n          {\n            "paramName": [Name of param in query],\n            "value": [Type dependent. Key to value in context if valueType = "context"],\n            "type": [SQL DB type. See: https://learn.microsoft.com/en-us/dotnet/api/system.data.sqldbtype],\n            "valueType": ["path" or "fixedValue" or "context"]\n          }\n        ],\n        "cache": {\n          "useCaching": [If true, query result is cached],\n          "cachingTimeout": [Cache timeout timespan]\n        }\n      }\n    },\n    {\n      "xsltTransform": [Name of XSLT file],\n      "extensions": [\n        {\n          "namespace": [Assembly namespace],\n           "assemblyName": [Assembly name],\n           "className": [Assembly class name],\n           "dependencies": [\n             "[DLL dependency file name]",\n             "[DLL dependency file name]"\n           ]\n        }\n      ]\n    }\n  ],\n  "options": {\n    "configCache": {\n      "useCaching": [If true, config file is cached],\n      "cachingTimeout": [Cache timeout timespan]\n    },\n    "indentResult": [If true, Transco results will be formatted and indented]\n  }\n }\n'})})]})]}),(0,s.jsxs)(o.A,{value:"matrix-basic",label:"Matrix basic promote",children:[(0,s.jsxs)(n.p,{children:["The basic promote is a simple way of promoting values to the context. This version accept a simple list of parameters and promotes them to the Context. Values are not required, ",(0,s.jsx)("u",{children:"any values not supplied will not be present in the response object and will be ignored."})]}),(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["Transco XML/JSON also supports promotion of values to the context. This is achieved by setting the ",(0,s.jsx)(n.code,{children:"promoteToContext=true"})," in the Transco configuration file. The ",(0,s.jsx)(n.code,{children:"destination"})," property must also be set to the key of the desired destination in the context. With these two properties, any result from the SQL operation is saved to the context."]})}),(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Supported request parameter"}),(0,s.jsx)(n.th,{children:"type"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"KeyValueCollection"})}),(0,s.jsxs)(n.td,{children:["Key-Value collection ",(0,s.jsx)("br",{})," (each pair is individually promoted)"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Flow"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Domain"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Service"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Action"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Version"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Sender"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ApplicationName"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Milestone"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ConversationId"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"CorrelationId"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"BatchId"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Data1"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Data2"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Data3"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string"})})]})]})]}),(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:(0,s.jsx)(n.strong,{children:"Full request body JSON example"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'// POST /api/api/MatrixBasicPromote\n{\n "Content":  "ew0KICAiQ291bnRyeUNvZGUiOiAiQkUiLA0KICAiTW9uZXkiOiAgeyAiQW1vdW50IjogIDUwLCAiQ3VycmVuY3kiOiAgIkdCUCIgIH0NCn0NCg==",\n "Context":  {\n "x-conversationId":  "29500405-d7cf-4877-a72b-a3288cff9dc0",\n "x-correlationId":  "fc13d345-ebd7-44f2-89a9-4371258c0a08",\n "x-batchId":  "975f7ea4-6247-431b-afb6-6d27fb47516f",\n "x-applicationName":  "InvoiceApp",\n "filter":  "endtoendintegrationtests"\t    \n },   \n "KeyValueCollection":  {\n  "w":  3,\n  "l":  10.2,\n  "h":  1,\n  "t":  200,\n },\n "Flow":  "fl1",\n "Domain":  "do",\n "Service":  "sr1",\n "Action":  "Ac",\n "Version":  "Vs",\n "Sender":  "Snd",\n "ApplicationName":  "Snd",\n "Milestone":  "2018",\n "ConversationId":  "29500405-d7cf-4877-a72b-a3288cff9dc0",   \n "CorrelationId":  "29500405-d7cf-4877-a72b-a3288cff9dc0", \n "BatchId":  "29500405-d7cf-4877-a72b-a3288cff9dc0",  \n "Data1":  "d1", \n "Data2":  "d2", \n "Data3":  "d3"\n}\n'})})]}),(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:(0,s.jsx)(n.strong,{children:"Full response body JSON example"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'// 200 OK /api/api/MatrixBasicPromote\n{\n    "content": "ew0KICAiQ291bnRyeUNvZGUiOiAiQkUiLA0KICAiTW9uZXkiOiAgeyAiQW1vdW50IjogIDUwLCAiQ3VycmVuY3kiOiAgIkdCUCIgIH0NCn0NCg==",\n    "context": {\n        "x-conversationId": "29500405-d7cf-4877-a72b-a3288cff9dc0",\n        "x-correlationId": "fc13d345-ebd7-44f2-89a9-4371258c0a08",\n        "x-batchId": "975f7ea4-6247-431b-afb6-6d27fb47516f",\n        "x-applicationName": "InvoiceApp",\n        "filter": "endtoendintegrationtests",\n        "Flow": "fl1",\n        "Domain": "do",\t    \n        "Service": "sr1",\n        "Action": "Ac",\n        "Version": "Vs",\n        "ApplicationName": "Snd",\n        "Milestone": "2018",\n        "Data1": "d1",\n        "Data2": "d2",\n        "Data3": "d3",\n        "Sender": "Snd",\n        "w": 3,\n        "l": 10.2,\n        "h": 1,\n        "t": 200\n    },\n    "conversationId": null,\n    "correlationId": null,\n    "batchId": "29500405-d7cf-4877-a72b-a3288cff9dc0"\n}\n'})})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"customization",children:"Customization"}),"\n",(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:(0,s.jsx)(n.strong,{children:"Available Bicep parameters"})}),(0,s.jsxs)(n.p,{children:["The following Bicep parameters control the inner workings of the ",(0,s.jsx)(n.strong,{children:"Transco V2"})," component. See the ",(0,s.jsx)(n.a,{href:"/framework/installation/",children:"release pipeline step of the deployment of the Invictus Framework"})," to learn more."]}),(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Bicep parameter"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"storageAccountName"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"invictus{resourcePrefix}store"})}),(0,s.jsxs)(n.td,{children:["The name of the Azure Storage Account (used by other Framework components as well) where the ",(0,s.jsx)(n.code,{children:"transcov2configstore"})," Azure Blob Storage container will be located."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"keyVaultName"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"invictus-${resourcePrefix}-vlt"})}),(0,s.jsx)(n.td,{children:"The name of the Azure Key Vault (used internally by other Framework components as well for Microsoft authentication) where the Transco retrieves its SQL connection string."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"appInsightsName"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"invictus-${resourcePrefix}-appins"})}),(0,s.jsx)(n.td,{children:"The name of the Azure Application Insights resource where the Transco V2 component sends its telemetry."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"transcoV2FunctionName"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"inv-${resourcePrefix}-transco-v2"})}),(0,s.jsxs)(n.td,{children:["The name of the Azure Container App to be created for the ",(0,s.jsx)(n.strong,{children:"Transco V2"})," component."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"transcoV2Scaling"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"{ cpuResources: '0.5', memoryResources: '1.0Gi', scaleMaxReplicas: 1, scaleMinReplicas: 0, concurrentRequests: 10 }"})}),(0,s.jsxs)(n.td,{children:["The Container App options to control scaling. See ",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/container-apps/scale-app?pivots=container-apps-bicep#custom",children:"scaling rules in Azure Container Apps"}),"."]})]})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"migrating-transco-v1-to-v2",children:"Migrating Transco v1 to v2"}),"\n",(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:(0,s.jsx)("h4",{id:"migrating-Transco-v1-to-v2",style:{margin:0},children:"Migrating Transco v1 to v2"})}),(0,s.jsx)(n.p,{children:"We need to change the authentication and endpoint and remove the metadata links."}),(0,s.jsxs)(n.p,{children:["Also we need to change the Transco configuration files, for this you can use the migration tool from Codit's integration practice that can be found ",(0,s.jsx)(n.a,{href:"https://github.com/Codit/integration-practice/tree/main/src/Tools/Invictus/Transco-Matrix-Migration#invictus-Transco--matrix-migration-tools",children:"here"}),"."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:'"Transform_XML": {\n  "type": "Http",\n  "inputs": {\n    "method": "POST",\n-   "uri": "[parameters(\'invictus\').Framework.Transco.v1.TranscoXmlUrl]",\n+   "uri": "[parameters(\'invictus\').Framework.Transco.v2.TranscoXmlUrl]",\n    "authentication": {\n-     "username": "Invictus",\n-     "password": "@parameters(\'invictusPassword\')",\n-     "type": "Basic",\n+     "identity": "[parameters(\'infra\').managedIdentity.id]",\n+     "audience": "[parameters(\'invictus\').authentication.audience]",\n+     "type": "ManagedServiceIdentity"\n    },\n    "body": {\n      "Content": "@triggerBody()?[\'Content\']",\n      "Context": "",\n      "TranscoConfig": "EFACT_D96A_ORDERS-to-Generic_Order.json"\n    }\n  },\n  "runAfter": {}\n}\n'})})]}),"\n",(0,s.jsxs)(r,{children:[(0,s.jsx)("summary",{children:(0,s.jsx)("h4",{id:"migrating-matrix-v1-to-v2",style:{margin:0},children:"Migrating Matrix v1 to Transco v2"})}),(0,s.jsx)(n.p,{children:"The Matrix component's functionality has been placed in the Transco v2 API."}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:'"Extract_Message_Context": {\n  "type": "Http",\n  "inputs": {\n    "method": "POST",\n-   "uri": "[parameters(\'invictus\').framework.matrix.v1.basicMatrixUrl]",\n+   "uri": "[parameters(\'invictus\').framework.Transco.v2.basicMatrixUrl]",\n    "body": {\n      "Domain": "B2B-Gateway",\n      "Service": "@{concat(\'AS2-Receive-\', body(\'Decode_AS2_message\')?.aS2Message?.aS2To)}",\n      "Action": "@{outputs(\'Integration_Account_Artifact_Lookup_-_Get_SendingPartner\')?.properties?.metadata?.PayloadFormat}",\n      "Version": "1.0",\n      "Sender": "@{outputs(\'Integration_Account_Artifact_Lookup_-_Get_SendingPartner\')?.properties?.metadata?.PartyName}",\n      "Content": "@{base64(body(\'Decode_AS2_message\')?.AS2Message?.Content)}",\n      "KeyValueCollection": {\n        "ReceiveFileName": "@{body(\'Decode_AS2_message\')?[\'AS2Message\']?[\'FileName\']}",\n        "ReceiveProtocol": "AS2",\n        "ReceiveProtocolDetails": "@{body(\'Decode_AS2_message\')?[\'AS2Message\']?[\'AS2From\']} > @{body(\'Decode_AS2_message\')?[\'AS2Message\']?[\'AS2To\']}",\n        "ReceiveReference": "@{body(\'Decode_AS2_message\')?[\'AS2Message\']?[\'OriginalMessageId\']}",\n        "ReceiveTimeUtc": "@{utcNow()}"\n      }\n\t},\n\t"authentication": {\n-     "username": "Invictus",\n-     "password": "@parameters(\'invictusPassword\')"\n-     "type": "Basic",\n+     "identity": "[parameters(\'infra\').managedIdentity.id]",\n+     "audience": "[parameters(\'invictus\').authentication.audience]",     \n+     "type": "ManagedServiceIdentity"\n\t}\n  },\n  "runAfter": {},\n- "metadata": {\n-   "apiDefinitionUrl": "[parameters(\'invictus\').framework.matrix.v1.definitionUrl]",\n-   "swaggerSource": "custom"\n- }\n}\n'})})]})]})}function m(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},9365(e,n,t){t.d(n,{A:()=>a});t(6540);var r=t(4164);const s="tabItem_Ymn6";var i=t(4848);function a({children:e,hidden:n,className:t}){return(0,i.jsx)("div",{role:"tabpanel",className:(0,r.A)(s,t),hidden:n,children:e})}},1470(e,n,t){t.d(n,{A:()=>w});var r=t(6540),s=t(4164),i=t(7559),a=t(3104),o=t(6347),c=t(205),l=t(7485),d=t(1682),h=t(679);function u(e){return r.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function m(e){const{values:n,children:t}=e;return(0,r.useMemo)(()=>{const e=n??function(e){return u(e).map(({props:{value:e,label:n,attributes:t,default:r}})=>({value:e,label:n,attributes:t,default:r}))}(t);return function(e){const n=(0,d.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,t])}function p({value:e,tabValues:n}){return n.some(n=>n.value===e)}function x({queryString:e=!1,groupId:n}){const t=(0,o.W6)(),s=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,l.aZ)(s),(0,r.useCallback)(e=>{if(!s)return;const n=new URLSearchParams(t.location.search);n.set(s,e),t.replace({...t.location,search:n.toString()})},[s,t])]}function f(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,i=m(e),[a,o]=(0,r.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find(e=>e.default)??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:i})),[l,d]=x({queryString:t,groupId:s}),[u,f]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,s]=(0,h.Dv)(n);return[t,(0,r.useCallback)(e=>{n&&s.set(e)},[n,s])]}({groupId:s}),j=(()=>{const e=l??u;return p({value:e,tabValues:i})?e:null})();(0,c.A)(()=>{j&&o(j)},[j]);return{selectedValue:a,selectValue:(0,r.useCallback)(e=>{if(!p({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),f(e)},[d,f,i]),tabValues:i}}var j=t(2303);const g="tabList__CuJ",b="tabItem_LNqP";var v=t(4848);function y({className:e,block:n,selectedValue:t,selectValue:r,tabValues:i}){const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,a.a_)(),l=e=>{const n=e.currentTarget,s=o.indexOf(n),a=i[s].value;a!==t&&(c(n),r(a))},d=e=>{let n=null;switch(e.key){case"Enter":l(e);break;case"ArrowRight":{const t=o.indexOf(e.currentTarget)+1;n=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(e.currentTarget)-1;n=o[t]??o[o.length-1];break}}n?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},e),children:i.map(({value:e,label:n,attributes:r})=>(0,v.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{o.push(e)},onKeyDown:d,onClick:l,...r,className:(0,s.A)("tabs__item",b,r?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function T({lazy:e,children:n,selectedValue:t}){const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=i.find(e=>e.props.value===t);return e?(0,r.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:i.map((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function A(e){const n=f(e);return(0,v.jsxs)("div",{className:(0,s.A)(i.G.tabs.container,"tabs-container",g),children:[(0,v.jsx)(y,{...n,...e}),(0,v.jsx)(T,{...n,...e})]})}function w(e){const n=(0,j.A)();return(0,v.jsx)(A,{...e,children:u(e.children)},String(n))}},445(e,n,t){t.d(n,{A:()=>r});const r=t.p+"assets/images/transco-v2-example-03ef57141bfe48292ae45677758f0d80.png"},8453(e,n,t){t.d(n,{R:()=>a,x:()=>o});var r=t(6540);const s={},i=r.createContext(s);function a(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);